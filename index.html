<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="js/getACCData.js"></script>
    <script src="js/ACCUpload.js"></script>
    <script src="js/variables.js"></script>
    <script src="js/uniclassClassifications.js"></script>
    <link rel="stylesheet" href="assets/css/main.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <link rel="icon" href="./assets/media/Keltbray-logo_single.png" type="image/x-icon">

    <title>Digital Delivery Hub - Peterhead ACC File Uploader</title>
</head>

<body>

    <header>
        <div class="header-section">
            <img alt="" id="headerlogo" class="logo_H" src="./assets/media/Keltbray-logo_single.png">
            <h2>Keltbray <br>DD Hub</h2>
        </div>
        <div class="header-section">
            <h1>Peterhead ACC File Uploader</h1>
        </div>
        <div class="header-section">
            <h3></h3>
        </div>
    </header>

    <main>
      <div id="loadingScreen">
        <div class="spinner"></div>
        <p>Loading ACC Data...</p>
      </div>
            <form class="" id="ACC_FileNo_Generator" >
                <div class="form-group">

                  <div class="form-container">
                    <h3 class="form-heading">Step 1. Generate file name</h3>
                    <label class="form-label form-label-top form-label-auto" id="label_folder" for="input_folder" aria-hidden="false"> Select file type </label>
                    <select class="form-dropdown" id="input_file_type" onchange="docNameTypeSelector()">
                      <option value="">Select a file type...</option>
                      <option value="Document">Document</option>
                      <option value="Drawing">Drawing</option>
                    </select>
                      <ul class="form-step1 docGenerator">
                      <!-- Project PIN Input-->
                          <li class="form-line" data-type="control_dropdown" id="id_5"><label class="form-label form-label-top form-label-auto" id="label_5" for="input_5" aria-hidden="false"> Contractor Codes </label>
                            <div id="cid_5" class="form-input-wide" data-layout="full">
                            <select class="form-dropdown" id="ProjectPin_input" name="" data-component="ProjectRole" aria-label="Project PIN">
                            </select> </div>
                          </li>
                          <!-- Spatial Input-->
                          <li class="form-line" data-type="control_dropdown" id="id_5"><label class="form-label form-label-top form-label-auto" id="label_5" for="input_5" aria-hidden="false"> Location Code </label>
                            <div id="cid_5" class="form-input-wide" data-layout="full">
                            <select class="form-dropdown" id="Spatial_input" name="" data-component="ProjectRole" aria-label="Spatial">
                            </select> </div>
                          </li>
                          <!-- Function Input-->
                          <li class="form-line docGeneratorDocument" data-type="control_dropdown" id="id_5"><label class="form-label form-label-top form-label-auto" id="label_5" for="input_5" aria-hidden="false"> Function </label>
                            <div id="cid_5" class="form-input-wide" data-layout="full">
                            <select class="form-dropdown" id="Function_input" name="" data-component="ProjectRole" aria-label="Function">
                            </select> </div>
                          </li>
                          <!-- Document Type Input-->
                          <li class="form-line docGeneratorDocument" data-type="control_dropdown" id="id_5"><label class="form-label form-label-top form-label-auto" id="label_5" for="input_5" aria-hidden="false"> Doc-Dwg Type </label>
                            <div id="cid_5" class="form-input-wide" data-layout="full">
                            <select class="form-dropdown" id="DocTypeDocument_input" name="" data-component="ProjectRole" aria-label="Discipline">
                            </select> </div>
                          </li>
                          <!-- Drawing Type Input-->
                          <li class="form-line docGeneratorDrawing" data-type="control_dropdown" id="id_5"><label class="form-label form-label-top form-label-auto" id="label_5" for="input_5" aria-hidden="false"> Doc-Dwg Type </label>
                            <div id="cid_5" class="form-input-wide" data-layout="full">
                            <select class="form-dropdown" id="DocTypeDrawing_input" name="" data-component="ProjectRole" aria-label="Discipline">
                            </select> </div>
                          </li>
                          <!-- Discipline Input-->
                          <li class="form-line docGeneratorDrawing" data-type="control_dropdown" id="id_5"><label class="form-label form-label-top form-label-auto" id="label_5" for="input_5" aria-hidden="false"> Subject &amp; Discipline Code </label>
                            <div id="cid_5" class="form-input-wide" data-layout="full">
                            <select class="form-dropdown" id="Discipline_input" name="" data-component="ProjectRole" aria-label="Discipline">
                            </select> </div>
                          </li>
                          <!-- Originator Input-->
                          <li class="form-line docGeneratorDrawing" data-type="control_dropdown" id="id_5"><label class="form-label form-label-top form-label-auto" id="label_5" for="input_5" aria-hidden="false"> Originator Code </label>
                              <div id="cid_5" class="form-input-wide" data-layout="full">
                              <select class="form-dropdown" id="Originator_input" name="" data-component="ProjectRole" aria-label="Originator">
                              </select> </div>
                          </li>
                          <li class="form-line docGeneratorDrawing" data-type="control_dropdown" id="id_5"><label class="form-label form-label-top form-label-auto" id="label_5" for="input_5" aria-hidden="false"> Is your file an additional sheet </label>
                            <input type="checkbox" id="checkbox1">
                          </li>
                          <script>
                            document.addEventListener('DOMContentLoaded', function() {

                            // Get references to the checkbox and the other element
                                                           
                                // Add event listener to the checkbox
                                checkbox.addEventListener('change', function() {
                                    // If checkbox is checked, display the other element; otherwise, hide it
                                    if (checkbox.checked) {
                                      manualSequence.style.display = 'block'; // Display the other element
                                    } else {
                                      manualSequence.style.display = 'none'; // Hide the other element
                                    }
                                });
                              })
                          </script>
                          <li class="form-line" data-type="control_dropdown" id="manualSequence"><label class="form-label form-label-top form-label-auto" id="label_5" for="input_5" aria-hidden="false"> Please enter sequence number of existing file </label>
                            <input type="text" id="manualSequencetext">
                          </li>
                        </ul>
                        <ul class="form-step1 docGenerator fullwidth">
                          <li class="form-line fullwidth" ><label class="form-label form-label-top form-label-auto" id="label_5" for="input_5" aria-hidden="false"> Sequence Code and Sheet Numbers will be auto generated </label>
                            <div class="form-input-wide" data-layout="full">
                              </div>
                        </li>
                        
                      </ul>
                    <div class="form-step1 docGenerator">
                      <!-- Generate Button -->
                      <div id="cid_2" class="form-button" data-layout="full">
                          <button type="button" id="generate_btn" class="submitButton" onclick="generateDocName()">Generate File Name</button>
                      </div>
                    <!-- Document Number-->
                    <div class="form-output" data-type="control_email" id="id_7"><label class="form-label" id="label_7" for="input_7" aria-hidden="false"> Generated File Name </label>
                     <input type="text" id="DocNumber" name="DocNumber" class="form-textbox" size="15" value="" data-component="last" aria-labelledby="label_6 sublabel_6_last" readonly>
                    </div>
                    </div>
                </div>
                <div class="form-container">
                  <h3 class="form-heading">Step 2. Select Target Folder</h3>
                    <label class="form-label form-label-top form-label-auto" id="label_folder" for="input_folder" aria-hidden="false"> Upload folder location </label>
                    <select class="form-dropdown" id="input_folder" onchange="updateRevisionTextInput()">
                      <option value="">Select a folder...</option>
                    </select>
                  </div>
                  <div class="form-container">
                    <h3 class="form-heading">Step 3. Populate metadata</h3>
                    <label class="form-label form-label-top form-label-auto" id="label_file_origin" for="input_file_origin" aria-hidden="false"> Please populate all marked (*) fields </label>
                    <ul class="form-step1">
                      <li>
                        <label class="form-label form-label-top form-label-auto" id="label_title" for="input_title" aria-hidden="false"> Title* </label>
                        <input type="text" id="input_title">
                      </li>
                      <li>
                        <label class="form-label form-label-top form-label-auto" id="label_Description" for="input_Description" aria-hidden="false"> Description* </label>
                        <input type="text" id="input_Description">
                      </li>
                    </ul>
                    <ul class="form-step1">
                      <li>
                        <label class="form-label form-label-top form-label-auto" id="label_RevisionsCode" for="input_RevisionsCode" aria-hidden="false"> Revision Code* </label>
                        <input type="text" id="input_RevisionsCode" value="P01.01">
                      </li>
                      <li>
                        <label class="form-label form-label-top form-label-auto" id="label_RevisionDescription" for="input_RevisionDescription" aria-hidden="false"> Revision Description* </label>
                        <input type="text" id="input_RevisionDescription">
                      </li>
                      </ul>
                      <ul class="form-step1">
                        <li>
                          <label class="form-label form-label-top form-label-auto" id="label_Status" for="input_Status" aria-hidden="false"> Status Code* </label>
                          <select class="form-dropdown" id="input_Status" onchange="updateStatusTextInput()">
                            <option value="">Select a status code...</option>
                          </select>
                        </li>
                        <li>
                          <label class="form-label form-label-top form-label-auto" id="label_StatusDesc" for="input_StatusDesc" aria-hidden="false"> Status Description* </label>
                          <input type="text" id="input_StatusDesc" readonly>
                        </li>
                      </ul>
                      <ul class="form-step1">
                        <li>
                          <label class="form-label form-label-top form-label-auto" id="label_State" for="input_Status" aria-hidden="false"> State* </label>
                          <select class="form-dropdown" id="input_State">
                            <option value="">Select a state...</option>
                            
                            <script>
                              const list = [
                                  "Work In Progress",
                                  "Shared - at WIP",
                                  "Superseded - WIP",
                                  "Superseded - Shared at WIP",
                                  "Obsolete",
                                  "Superseded - Rejected in Check",
                                  "Superseded - Rejected in Review",
                                  "Superseded - Rejected in Approve",
                                  "Shared - for Co-ordination",
                                  "Shared - for Information",
                                  "Shared - for Comment",
                                  "Shared - For review and Approval",
                                  "Shared AP to LAP Review Approve",
                                  "Superseded - Shared",
                                  "Superseded - Rejected by Doc Con",
                                  "Superseded - Rejected by LAP",
                                  "Shared",
                                  "Shared - For Client Approval",
                                  "Shared -  AP Accepted",
                                  "Published",
                                  "Archived"
                              ];
                              
                              const dropdown = document.getElementById('input_State');
                              
                              // Add options for each item in the list
                              list.forEach(item => {
                                  const option = document.createElement('option');
                                  option.value = item;
                                  option.text = item;
                                  dropdown.add(option);
                              });
                              </script>
                          </select>
                        </li>
                        <li>
                          <label class="form-label form-label-top form-label-auto" id="label_Classification" for="input_StatusDesc" aria-hidden="false"> Classification </label>
                          <select class="form-dropdown" id="input_Classification">
                            <option value="">Select a classification...</option>
                          </select>
                        </li>
                      </ul>

                  </div>

                  <div class="form-container2">
                    <h3 class="form-heading">Step 4. Select file to upload</h3>
                    <label class="form-label form-label-top form-label-auto" id="label_file_origin" for="input_file_origin" aria-hidden="false"> Select upload origin (i.e. from Template or User PC) </label>
                    <select class="form-dropdown" id="input_file_origin" >
                      <option value="">Select a origin...</option>
                      <option value="Template Folder">Template Folder</option>
                      <option value="User PC">User PC</option>
                    </select>
                    <div id="templatesDropdown" class="form-templates">
                      <label class="form-label form-label-top form-label-auto" id="label_file_template" for="input_file_template" aria-hidden="false"> Select template to use </label>
                      <select class="form-dropdown" id="input_file_template" onchange="updateRevisionTextInput()">
                        <option value="">Select a template...</option>
                      </select>
                    </div>

                      <div id="drop-area" ondrop="handleDrop(event)" ondragover="handleDragOver(event)" ondragenter="handleDragEnter(event)" ondragleave="handleDragLeave(event)">
                        <i class="file-icon fas fa-file-alt"></i>
                        <p  onclick="openFileExplorer()">Click here or Drag and drop a file here</p>
                        <input type="file" id="fileInput" onchange="handleFileSelect(event)">
                      </div>
                    <div id="file-info"></div>
                  </div>

                  <div class="form-container">
                    <h3 class="form-heading">Step 5. Upload file</h3>

                    <button type="button" id="viewfile_btn" class="submitButton" onclick="runUpload()">Upload file to ACC</button>
                    <div class="progress-bar__container">
                      <div class="progress-bar-Main">
                        <span class="progress-bar-Main__text">File uploaded successfully</span>

                      </div>
                    </div>
                    <button type="button" id="reloadButton" class="submitButton uploadNew" >Upload another file</button>
                </div>
                </div>
              </form>

    </main>
    <script>

    </script>
</body>
</html>